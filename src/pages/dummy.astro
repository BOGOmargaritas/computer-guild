<main>
    <form method="post">
        <label>Enter your email</label>
        <input name="email" type="email" required />
        <button type="submit">Submit</button>
    </form>
</main>

<script>
    const form = document.querySelector("form");
    form.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        fetch("/api/add-email", {
            method: "POST",
            body: formData
        })
            .then((response) => response.json())
            .then((data) => {
                if (data.error) {
                    form.innerHTML = "<p>Something went wrong. Please try again later.</p>";
                } else {
                    form.innerHTML = "<p>Thank you for subscribing!</p>";
                }
            })
            .catch((error) => {
                console.log({ error });
                form.innerHTML = "<p>Something went wrong. Please try again later.</p>";
            });
    });
</script>
